# 第四章 语法分析 

功能： 根据文法规则，从源程序单词符号串中识别出语法成分，并进行语法检查。  

基本任务：识别符号串S是否为某语法成分。
两大类分析分发：

+ 自顶向下分析  
+ 自底向上分析  

## 自顶向下分析算法  

存在主要问题：

+ 左递归问题  
+ 回溯问题  

主要方法：  

+ 递归子程序法  
+ LL分析法  

## 自底向上分析算法  

存在主要问题：  

+ 句柄的识别问题  
+ 若两个以上规则的右部有相同的符号串且构成句柄，选哪个候选式  

主要方法：  

+ 算法优先分析法  
+ LR分析法  

## 自顶向下分析存在的问题及解决办法  

1. 左递归文法：

消除直接左递归：
方法一：使用扩充的BNF表示来改写文法  
![ ](snip9.png)  

+ 规则一（提因子）：

![ ](snip10.png)  

+ 规则二：  

![ ](snip11.png)  

方法二：将左递归规则改为右递归规则  

![ ](snip12.png)  

方法三：一般算法（代入法）  

![ ](snip13.png)  

2. 回溯问题  

**造成回溯的条件**：  
文法中，对于某个非终结符号的规则其右部有多个选择，并根据所面临的输入符号不能准确地确定所要的产生式，就可能出现回溯。  

**避免回溯的条件**：  
![ ](snip14.png)  

**消除回溯的途径**：

1. 改写文法  
对具有多个右部的规则反复提取左因子 
2. 超前扫描  
当文法不满足避免回溯的条件时，即各选择的首符号相交时，可以采用超前扫面的方法，即向前侦查个输入符号串的第二个、第三个符号来确定要选择的目标。  

### 文法的两个条件  

1. 文法是非左递归的；  
2. 对文法的任一非终结符，若其规则右部有多个选择时，各选择所推出的终结符号串的首符号集合要两两不相交。  

## 递归子程序法  

1. 检查文法是否存在左递归和回溯问题  
2. 递归子程序法对应的是最左推导过程  

## LL分析法  

![ ](snip15.png)  

执行过程：(**最左推导**)  
![ ](snip16.png)  

分析表的改造：  
![ ](snip17.png)  

**LL(1)文法的充分必要条件**:  
![ ](snip18.png)  

## 自底向上分析  

分析过程步骤：

1. 找出当前句型的句柄x(或句柄的变形）；)  
2. 找出以x为右部的规则 X::= x;  
3. 把x规约为X，产生语法树的一枝。  

### 移进、规约分析  

巧合算法  

### 算法优先分析 

**特点**：仿效四则运算过程，预先规定相邻终结符之间的优先关系，然后利用这种有限关系来确定句型的“句柄”，并进行规约。  
**出错情况**：

1. 相邻终结符之间无优先关系。  
2. 对双目运算符进行规约时，符号栈中无足够项。  
3. 非正常结束状态。  

**算符文法的定义**： 不允许两个非终结符相邻。  

**优先关系**：  
